<div align="center">
<H1>Kubernetes Architecture</H1>
</div>
<br>


## Что такоe Master Node in Kubernetes?

Главный узел — это отправная точка для всех административных задач, и он отвечает за управление архитектурой кластера Kubernetes.

В кластере может быть более одного главного узла, и это необходимо для проверки отказоустойчивости, так как большее количество главных узлов переводит систему в режим, известный как «Высокая доступность».

Однако один мастер-узел выполняет роль главного узла, выполняющего все задачи.


## Компоненты главного узла

**1) Kubernetes API server** -  С помощью сервера API обеспечивается работа API кластера, обрабатываются REST-операции и предоставляется интерфейс, через который остальные компоненты взаимодействуют друг с другом. Также через него проходят запросы на изменение состояния или чтение кластера. Работает на master-нодах;

- Сервер API внутри главного узла — это место, где будут выполняться все административные задачи.

- Команды REST отправляются на сервер API, который будет обрабатывать и проверять запросы.

- По запросу результирующее состояние кластера будет сохранено как "ключ-значение".

**2) Scheduler** - Компонент, планирующий, на каких узлах разворачивать поды. Он учитывает такие факторы, как ограничения, требования к ресурсам, местонахождение данных и пр. Работает на master-нодах; (Распределяет рабочие нагрузки на доступные рабочие узлы(work Nodes))  

Принцип работы:
- Вы создаёте под.
- Планировщик замечает, что у нового пода нет назначенного ему узла.
- Планировщик назначает поду узел.

**3) Controller manager** - Компонент запускает работу контроллеров. Работает на master-нодах

- Запускает все встроенные контроллеры(Node, Replication, Endpoints, Account & Token Controllers).  

**4) ETCD** - Распределенное хранилище в формате «ключ-значение». В нем хранится состояние всего кластера. Главная задача etcd — обеспечить отказоустойчивость кластера и консистентность данных

- Вы можете настроить ETCD извне или даже сделать его частью Kubernetes Master.

- ETCD написан на языке программирования "GO". В Kubernetes вы можете хранить детали конфигурации, такие как Secrets, ConfigMaps, подсети и т. д., а также сохранять состояние кластера.

**5) Cluster DNS (опцональный компонент)**

- Предоставляет внутрикластерный DNS для Pods и Services, обычно предоставляется с использованием плагинов K8s от CoreDNS.

**6) Cloud Controll Manager (Опциональный компонент)**

- Запуск и управление ресурсами облачных сервисов. Общается через API облачного провайера (AWS, Azure и т.п.). 
Например: Load balancer endpoint или Storage volume allocation.

---

## Worker Node Architecture

Рабочий узел(Node) запускает приложения через модули(Pods), а главный узел управляет модулями.  
Nodes (ноды, узлы)- то физические или виртуальные машины, на которых развертываются и запускаются контейнеры с приложениями. Совокупность нод образует кластер Kubernetes.

## Worker Node Components

**1. Container runtime**

- Worker Node требуется среда выполнения контейнера для управления и запуска жизненного цикла контейнера.

- Docker часто путают со средой выполнения контейнеров, но это платформа, которая использует контейнеры похожим образом.

**2. Kubelet** - Cлужба, которая управляет состоянием ноды: запуском, остановкой и поддержанием работы контейнеров и подов. Работает на worker-нодах. (Управляет контейнерами на основе входящей Pod спецификаций использует Container runtime.)  

- Kubelet взаимодействует с Master Node и выполняется на рабочих узлах. Он получает спецификации Pod через server API. Кроме того, он запускает связанные контейнеры в исправном Pod-e.

**3. cAdvisor**

- cAdvisor служит для анализа всех показателей использования сети, файлов, ЦП и памяти для каждого контейнера, работающего на указанном узле. Вы должны найти хороший инструмент для мониторинга, так как cAdvisor не может предложить решение для долгосрочного хранения.

**4. Kube-proxy** - Служба, которая управляет правилами балансировки нагрузки. Она конфигурирует правила IPVS или iptables, через которые выполняются проксирование и роутинг. Работает на worker-нодах. (Управляет сетью соединения с модулями узла.)

- Kube-proxy работает на каждом Node и работает с каждой подсетью хоста отдельно, чтобы гарантировать, что внешние стороны имеют доступ ко всем службам.

- Он также играет роль балансировщика нагрузки и сетевого прокси для любой службы, расположенной на рабочем Node. Кроме того, kube-proxy будет управлять сетевой маршрутизацией пакетов UDP и TCP.

- Сетевой прокси запускается на каждом рабочем Node и идет за endpoint для каждой службы (удаление/создание) на server API.

____________________________


<img src="https://github.com/AYaskuld/Kubernetes/blob/7bf9d4e66ea6a87e2daf8933c157605c0b945648/images/architecture.jpg" width="800" height="600" >
